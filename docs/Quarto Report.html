<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aya Derouiche">
<meta name="dcterms.date" content="2024-04-25">

<title>Educational Disparity by Continent Report: Factors and Effects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: black;
      }

      .quarto-title-block .quarto-title-banner {
        color: black;
background: #f0f3f5;
      }
</style>


<link rel="stylesheet" href="style.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Educational Disparity by Continent Report: Factors and Effects</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aya Derouiche </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 25, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose"><span class="header-section-number">1.1</span> Purpose</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">1.2</span> Methodology</a></li>
  </ul></li>
  <li><a href="#analysis-of-global-educational-disparities" id="toc-analysis-of-global-educational-disparities" class="nav-link" data-scroll-target="#analysis-of-global-educational-disparities"><span class="header-section-number">2</span> Analysis of Global Educational Disparities</a>
  <ul class="collapse">
  <li><a href="#educational-proficiency-across-continents" id="toc-educational-proficiency-across-continents" class="nav-link" data-scroll-target="#educational-proficiency-across-continents"><span class="header-section-number">2.1</span> Educational Proficiency Across Continents</a></li>
  <li><a href="#trends-of-educational-outcomes" id="toc-trends-of-educational-outcomes" class="nav-link" data-scroll-target="#trends-of-educational-outcomes"><span class="header-section-number">2.2</span> Trends of Educational Outcomes</a>
  <ul class="collapse">
  <li><a href="#regional-comparison" id="toc-regional-comparison" class="nav-link" data-scroll-target="#regional-comparison"><span class="header-section-number">2.2.1</span> Regional Comparison</a></li>
  <li><a href="#time-series-analysis-educational-trends-by-continent" id="toc-time-series-analysis-educational-trends-by-continent" class="nav-link" data-scroll-target="#time-series-analysis-educational-trends-by-continent"><span class="header-section-number">2.2.2</span> Time Series Analysis: Educational Trends by Continent</a></li>
  </ul></li>
  <li><a href="#correlation-analysis-education-gdp-and-life-expectancy" id="toc-correlation-analysis-education-gdp-and-life-expectancy" class="nav-link" data-scroll-target="#correlation-analysis-education-gdp-and-life-expectancy"><span class="header-section-number">2.3</span> Correlation Analysis: Education, GDP, and Life Expectancy</a></li>
  </ul></li>
  <li><a href="#conclusion-and-recommendations" id="toc-conclusion-and-recommendations" class="nav-link" data-scroll-target="#conclusion-and-recommendations"><span class="header-section-number">3</span> Conclusion and Recommendations</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">3.1</span> Conclusion</a></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations"><span class="header-section-number">3.2</span> Recommendations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<hr>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The <strong><em>Educational Disaprity</em></strong> report gives an extensive overview of educational systems across different continents, using a wide range of data visualization methods to reveal hidden patterns and disparities in education outcomes. It examines various metrics such as literacy rates, school enrollment numbers and levels of educational attainment for a better insight into the intricate dynamics that shape global education.</p>
<p>This analysis offers profound insights into socio-economic and policy environments that influence educational landscapes worldwide. It is a comprehensive guide for policy makers, academic institutions, and international organizations with an aim of making informed decisions that can improve education opportunities and quality for different populations across continents.</p>
<section id="purpose" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="purpose"><span class="header-section-number">1.1</span> Purpose</h2>
<p>The primary aim of this report is to:</p>
<ul>
<li><strong>Identify</strong> key trends in education globally.</li>
<li><strong>Analyze</strong> disparities in educational outcomes across different geographical regions.</li>
<li><strong>Explore</strong> the relationships between educational levels, economic conditions, and life expectancy.</li>
</ul>
</section>
<section id="methodology" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="methodology"><span class="header-section-number">1.2</span> Methodology</h2>
<p>Our methodology encompasses:</p>
<ul>
<li><strong>Mapping</strong> global educational data to visually represent geographical disparities.</li>
<li><strong>Comparative analysis</strong> by continent to highlight differences and similarities in educational outcomes.</li>
<li><strong>Time series analysis</strong> to trace the evolution of education over recent years.</li>
<li><strong>Statistical modeling</strong> to examine the correlations between education, GDP, and life expectancy.</li>
</ul>
<hr>
</section>
</section>
<section id="analysis-of-global-educational-disparities" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Analysis of Global Educational Disparities</h1>
<section id="educational-proficiency-across-continents" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="educational-proficiency-across-continents"><span class="header-section-number">2.1</span> Educational Proficiency Across Continents</h2>
<p>Our analysis highlights significant disparities in educational outcomes across different continents, with a particular focus on the proficiency levels in reading at the end of lower secondary education. The visualization below illustrates that many countries in <strong><em>Africa</em></strong> have the lowest percentage of students achieving at least a minimum proficiency level in reading, starkly contrasting with countries in <strong><em>Europe</em></strong>, <strong><em>Asia</em></strong>, and <strong><em>North America</em></strong>, where a relatively high percentage of students meet or exceed this educational threshold.</p>
<p>This disparity points to systemic issues that may include but are not limited to, <strong>resource allocation</strong>, <strong>educational policies</strong>, and <strong>socio-economic</strong> factors that impact educational systems across the globe.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Quarto-Report_files/figure-html/world map plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="trends-of-educational-outcomes" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="trends-of-educational-outcomes"><span class="header-section-number">2.2</span> Trends of Educational Outcomes</h2>
<section id="regional-comparison" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="regional-comparison"><span class="header-section-number">2.2.1</span> Regional Comparison</h3>
<div style="float:right;position: relative; top: 5px;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Quarto-Report_files/figure-html/bar-chart-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<p>This bar chart provides a clear visualization of the disparities in educational outcomes across different continents as of the latest data point. The chart highlights the variance in educational achievements, which can be attributed to a multitude of socio-economic factors unique to each continent. Notice the stark differences between continents such as <strong><em>Africa</em></strong> compared to <strong><em>North America</em></strong> and <strong><em>Asia</em></strong>.</p>
</section>
<section id="time-series-analysis-educational-trends-by-continent" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="time-series-analysis-educational-trends-by-continent"><span class="header-section-number">2.2.2</span> Time Series Analysis: Educational Trends by Continent</h3>
<p>Varied trends in educational outcomes across continents have been revealed by the time series graph provided below, indicating significant disparities in transition rates from primary to secondary and tertiary education. Notably, no significant improvement or a slight decline in educational outcomes has been experienced in <strong>Africa</strong> and <strong>Europe</strong>. This is largely attributed to <strong>limited household incomes</strong>, which directly impact children’s access to educational opportunities. Additionally, efforts to create equal access to quality education across these regions are hampered by <strong>inadequate government investment</strong> in education infrastructure.</p>
<p>In contrast, a positive trend has been shown in <strong>the Americas</strong>, where educational outcomes are on the rise. This improvement suggests that more effective educational policies and investments have been implemented compared to other regions. However, the <strong>southern regions</strong> of asia have faced a deline. This decline highlights critical vulnerabilities in the region’s educational framework, including economic instabilities and uneven distribution of educational resources, which necessitate urgent attention and strategic policy interventions to reverse the negative trends.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Quarto-Report_files/figure-html/time series-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="correlation-analysis-education-gdp-and-life-expectancy" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="correlation-analysis-education-gdp-and-life-expectancy"><span class="header-section-number">2.3</span> Correlation Analysis: Education, GDP, and Life Expectancy</h2>
<div style="float:right;position: relative; top: 5px;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Quarto-Report_files/figure-html/obs and gdp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Quarto-Report_files/figure-html/gdp and life_exp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Numerous studies have indicated a <strong>positive link</strong> between <strong>education</strong> and <strong>GDP</strong>, as well as between <strong>GDP</strong> and <strong>life expectancy</strong>. Such correlations reiterate the weight of education levels attained and economic performance on national health and life expectancies. It has been observed that increased education leads to better economic outcomes, which subsequently result in improved life quality standards and longer-living populations.</p>
<p>Another important way in which education affects the level of <strong>income</strong>, is by determining who gets what part of the resources. This is influenced through direct financial benefits such as salary increments or promotions, but also through social gains like higher productivity rates and more invention. When considering health factors, there has been a positive trend among some countries where income levels rise with educational attainment. Consequently, regions with higher GDP per capita have experienced increased longevity due to healthy living resulting from better educational systems.</p>
<p>This can also be seen in economies that place high premium on education. In this regard, economies experiencing higher GDP growth tend to have better healthcare services leading to improved living conditions as well as public health outcomes (World Bank). Scatter charts show that regions that invest more in schooling not only enjoy increased GDP figures but also longest average lifespan.</p>
</section>
</section>
<section id="conclusion-and-recommendations" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Conclusion and Recommendations</h1>
<section id="conclusion" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">3.1</span> Conclusion</h2>
<p>This report has provided a comprehensive analysis of global educational trends using world maps, bar charts, time series as well as scatter charts among others. According to these visualizations, there are significant differences in education, GDP, and life expectancy on different continents.</p>
<p>The world map indicated striking regional discrepancies in educational achievements stressing the problems faced by <strong>Africa</strong> and some parts of southern <strong>Asia</strong>. On the other hand, the bar chart showed notable disparities among continents where regions such as <strong>Africa</strong>, <em>Europe</em>, <em>the Americas</em> or <em>Asia</em> seemed to have experienced challenges or improvements concerning their educational outcomes at different times.</p>
<p>Time series demonstrated static/downturns in Europe &amp; Africa while America witnessed an upturn &amp; Asia suffered massive depreciation particularly in Southern regions. These patterns show how economics interacts with education.</p>
<p>Finally, correlation scatter charts highlighted positive associations amid education rates vis-à-vis GDP together with life span. As well as emphasizing the critical role played by education towards better income and health outcomes at society level; these charts further showed that high prevalence is associated with better living standards.</p>
</section>
<section id="recommendations" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="recommendations"><span class="header-section-number">3.2</span> Recommendations</h2>
<p>Based on findings from this study; hereby suggested recommendations can help tackle the identified challenges while making use of the available opportunities:</p>
<ul>
<li><p><strong><em>Increase Governmental and Private Investment in Education</em></strong>: Especially where shortcomings are noted in certain regions, to guarantee equal access to education.</p></li>
<li><p><strong><em>Improve Educational Infrastructure</em></strong>: Better school facilities and resources should be available for better results in education and hence higher growth rates of the economy.</p></li>
<li><p><strong><em>Targeted Implementation of Educational Programs</em></strong>: For instance, in some cases like Southern Asia, a region that has significant inconsistencies or regressions demand educational initiatives that target specific local communities.</p></li>
<li><p><strong><em>Policy Cohesion between Education and Economic Development</em></strong>: Policies must encourage the linkages between education and economic development objectives to ensure that enhanced learning is translated into economic and health gains.</p></li>
<li><p><strong><em>Adaptation through Monitoring of Education Strategies</em></strong>: Continuously monitor educational outcomes while ensuring strategies are effective and responsive to changing socio-economic conditions.</p></li>
</ul>
<p>It is about investing on the future generation. All countries need to invest proactively and strategically in their education systems, so as to promote global economic growth prospects including enhancing public health worldwide.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>